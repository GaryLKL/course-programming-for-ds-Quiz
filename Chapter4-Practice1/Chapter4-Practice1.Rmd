---
title: "Chapter4"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
knitr::opts_chunk$set(echo = FALSE)
```


## Practice 1

---

> Question 1 

```{r Prac1Quiz1}
quiz(
  question("If you type c(2L, 'a', 3.0, 4), how will the data type of \"2L\" be changed?",
    answer("From an integer to a character", correct = TRUE),
    answer("From a numeric to an integer"),
    answer("From an integer to a numeric"),
    answer("From a character to an integer"),
    incorrect = "Incorrect! Type help(c) and read the description part carefully.",
    allow_retry = TRUE
  )
)
```

解答：  
在Console中，輸入：c(2L, 'a', 3.0, 4)，  
輸出結果：[1] "2" "a" "3" "4"  
由於向量中，存在'a'的資料型態（data type）為character，  
可以看到輸出結果的每個元素都被雙引號包覆著，  
代表所有元素的資料型態都被設定為character，  
原本2L為integer，但在此向量的輸出結果為character。  


---

> Question 2

On line 3, show the first 10 rows of student. 
\
\
*(If you cannot figure it out, please click "hint".)*
```{r Prac1Quiz2, exercise=TRUE, exercise.lines = 5, exercise.eval=TRUE, message = F}
library(readr)
student <- read_csv("https://raw.githubusercontent.com/tpemartin/course-107-1-programming-for-data-science/master/data/student.csv")

```
```{r Prac1Quiz2-hint-1}
?head()
#Find the argument for setting the number of rows
```

```{r Prac1Quiz2-hint-2}
head(student, n = 10)
```

---

> Question 3

Now, finish the following requirement in only one step. \
1. Set gender as a factor. \
2. Change labels: 男性 to Male & 女性 to Female
\
\
*(If you cannot figure it out, please click "hint".)*
```{r Prac1Quiz3, exercise=TRUE, exercise.lines = 5}
gender <- c("男性", "男性", "女性", "男性", "女性", "男性")
```

```{r Prac1Quiz3-hint-1}
?factor
#Find the argument for setting the labels
```

```{r Prac1Quiz3-hint-2}
gender <- factor(x = gender, levels = c("男性", "女性"), labels = c("Male", "Female"))
```

---

## Practice 2 

*資料來源：[颱風資料庫](http://rdc28.cwb.gov.tw/TDB/ntdb/pageControl/typhoon)  *

> Question 1

**請將西元年(Year)轉成民國年份**  
**(舉例：2018 -> 107)**

步驟一：  
目前Year的資料型態為character，請利用as.integer函數將其轉變成integer型態，才能去做數學運算    

步驟二：  
減去1911  

```{r Prac2Quiz1, exercise = TRUE, exercise.lines = 10, exercise.eval = TRUE, message = FALSE}
library(readr)
library(stringr)
library(lubridate)
TyphoonData <- read_csv("https://raw.githubusercontent.com/GaryLKL/course-programming-for-ds-Quiz/master/TyphoonData.csv", col_types = cols(.default = col_character()))
Year <- TyphoonData$年份


```

```{r Prac2Quiz1-hint}
#step 1
Year <- as.integer(Year)
#step 2
Year <- Year - 1911
```

---

> Question 2

**承上題，假設你已經將Year轉成民國年份。**  
**請先將Year的資料型態轉變回character，並在時間的前後加上『民國』、『年』**  
**(舉例：107 -> 民國107年)**

步驟一：  
使用as.character函數，將Year的資料型態轉回character  

步驟二：  
使用stringr套件中的str_c函數，合併『民國』、『Year』、『年』

```{r Prac2Quiz2, exercise = TRUE, exercise.lines = 10, exercise.eval = TRUE, message = FALSE}
library(readr)
library(stringr)
library(lubridate)
TyphoonData <- read_csv("https://raw.githubusercontent.com/GaryLKL/course-programming-for-ds-Quiz/master/TyphoonData.csv", col_types = cols(.default = col_character()))
Year <- TyphoonData$年份
Year <- as.integer(Year) - 1911

```

```{r Prac2Quiz2-hint}
#step 1
Year <- as.character(Year)
#step 2
Year <- str_c("民國", Year, "年")
```

---

> Question 3

**請問哪一個月發布颱風警報的頻率最高?**  
**(變數Time為發布警報的時間)**  

步驟一：  
請用stringr套件的str_sub函數提出月份（第6、7位數字）

步驟二：  
再用table函數計算各月份的颱風警報頻率

```{r Prac2Quiz3, exercise = TRUE, exercise.lines = 10, exercise.eval = TRUE, message  = FALSE}
library(readr)
library(stringr)
TyphoonData <- read_csv("https://raw.githubusercontent.com/GaryLKL/course-programming-for-ds-Quiz/master/TyphoonData.csv", col_types = cols(.default = col_character()))
Time <- TyphoonData$發布警報時間
```

```{r Prac2Quiz3-hint-1}
#下方為提示、參考做法，並非解答。
library(stringr)
a <- c("1958-07-13 12:00", "1958-07-05 00:00", "1959-09-11 09:00")
b <- str_sub(a, start = 6, end = 7)
table(b)
```

```{r Prac2Quiz3-hint-2}
#解答
library(stringr)
Month <- str_sub(Time, 6,7)
table(Month)
#或直接
table(str_sub(Time, 6,7))
```


## Practice 3

---

> Question 1

**假設你簽了2年的房租合約，從2018年1月起至2019年12月，房租以「月」繳的方式，且每個月的10號前必須繳清。請寫出一個vector，儲存2018-01-10，2018-02-10，2018-03-10，...，2019-12-10，用以記錄每個月的繳費期限。**

```{r Prac3Quiz1, exercise = TRUE, exercise.lines = 5, exercise.eval = TRUE, message  = FALSE}
#參考講義4.5的seq()函式
```

---

> Question 2

**(Date為10月份中，隨機選取10天的結果。)**\
**請使用lubridate套件中的wday()函式，來查看這10天分別是「星期幾」。**

```{r Prac3Quiz2, exercise = TRUE, exercise.lines = 5, exercise.eval = TRUE, message  = FALSE}
set.seed(123)
Date <- sample(seq(ymd("2018-10-01"), ymd("2018-10-31"), by = 'day'), 10) 
Date

```

```{r Prac3Quiz2-hint-1}
#(註)：會使用到的Arguments有：x、label
#wday(x = , label = )
```

---

> Question 3

*資料來源：[行政院主計總處-統計資料查詢系統](https://win.dgbas.gov.tw/dgbas04/bc5/EarningAndProductivity/Default.aspx)*

**source為工業部門每人每月薪資的年平均資料，總共有民國62年～民國106年。**\
**1. 請使用read_csv()將source讀入Rstudio，並儲存成一個變數：salary。**\
**2. 請使用tail()抓出最後10年。(PS. tail()的作用與head()相反。記得操作完後，要存回去salary。)**\
**3. 請使用\'$\'，提出salary中的營造業 (hint: salary\$營造業)，並代入以下三式使用。**\
**4. 請使用三個函式mean()、max()、min()，幫我計算這十年營造業每人每月薪資的「總平均」、「最大值」、「最小值」。**

```{r Prac3Quiz3, exercise = TRUE, exercise.lines = 15, exercise.eval = TRUE, message  = FALSE}
library(readr)
source <- "https://raw.githubusercontent.com/GaryLKL/course-programming-for-ds-Quiz/master/AverageSalary.csv"



```

```{r Prac3Quiz3-hint-1}
#salary <- read_csv(file = )
#salary <- tail(x = salary, n = )
#mean(salary$營造業)
#max()
#min()

```

---

## Practice 4
*資料來源：[颱風資料庫](http://rdc28.cwb.gov.tw/TDB/ntdb/pageControl/typhoon)*\


> Question 1

**1. 將「近臺強度」改成factor**\
**2. 將「最低氣壓」、「最大風速」、「7級風暴風半徑(km)」、「10級風暴風半徑(km)」改成numeric**\

```{r Prac4Quiz1, exercise = TRUE, exercise.lines = 10, exercise.eval = TRUE, message  = FALSE}
library(readr)
TyphoonData <- read_csv("https://raw.githubusercontent.com/GaryLKL/course-programming-for-ds-Quiz/master/TyphoonData.csv")


```

```{r Prac4Quiz1-hint-1}
#as.factor()
#as.numeric()
```

---

> Question 2

**1. 參考講義5.4.4，使用which()，提出近10年 (2009~2018)的資料**\
**2. 使用table()，計算近10年，「近臺強度」的強烈、中度、輕度出現次數各為多少？**\

```{r Prac4Quiz2, exercise = TRUE, exercise.lines = 10, exercise.eval = TRUE, message  = FALSE}
library(readr)
TyphoonData <- read_csv("https://raw.githubusercontent.com/GaryLKL/course-programming-for-ds-Quiz/master/TyphoonData.csv")
index1 <- which(TyphoonData$年份 >= 2009) 

```

```{r Prac4Quiz2-hint-1}
#TyphoonData[index1,]
```

---

> Question 3

**1. 延續前題，TyphoonData$年份 %in% 2009:2018，來提出近10年的資料**\
**2. 找出近10年且當近臺強度為中度時，最大風速的最大值為多少**\
```{r Prac4Quiz3, exercise = TRUE, exercise.lines = 10, exercise.eval = TRUE, message  = FALSE}
library(readr)
TyphoonData <- read_csv("https://raw.githubusercontent.com/GaryLKL/course-programming-for-ds-Quiz/master/TyphoonData.csv")
index2 <- TyphoonData$年份 %in% 2009:2018

```

```{r Prac4Quiz3-hint-1}
#TyphoonData[index2,]
#max() 可找出最大值
```

---

## Practice 5
*資料來源：[IMDB](https://www.imdb.com/?ref_=nv_home)*\
**這筆資料集來自IMDB，為2014年至2017年電影排行（根據熱門程度排名），總共蒐集了7201部電影。**

> Question 1

**1. 請使用head()，看看這筆資料長怎樣**\
**2. 請用dim()、ncol()、nrow()，觀察資料集有幾個row和column**\
**3. 請使用names()、colnames()，查看這筆資料的變數名稱**\
**4. 請使用summary()，觀察變數「片長」的最大值、最小值、平均數、中位數**\
```{r Prac5Quiz1, exercise = TRUE, exercise.lines = 15, exercise.eval = TRUE, message  = FALSE}
library(readr)
IMDBData <- read_csv("https://raw.githubusercontent.com/GaryLKL/course-programming-for-ds-Quiz/master/imdb_movies.csv")

```

---

> Question 2

**1. 請幫我找出電影Ant-Man的排名、片長、類型**\
**2. 請使用table()，查看各「年份」電影出現的次數**\
**3. 請問類型為Drama的電影中，片長最短 (提示：使用min()) 的是哪一部？**\
```{r Prac5Quiz2, exercise = TRUE, exercise.lines = 15, exercise.eval = TRUE, message  = FALSE}
library(readr)
IMDBData <- read_csv("https://raw.githubusercontent.com/GaryLKL/course-programming-for-ds-Quiz/master/imdb_movies.csv")

```

```{r Prac5Quiz2-hint-1}
#1.
IMDBData[IMDBData$片名 == "Ant-Man", c("排名","片長","類型")]
```

---

> Question 3

**1. 請幫我將「類型」轉成factor**\
**2. 「類型」總共有幾類呢？**\
**3. 參考電子書5.4.7，使用cut()，為「片長」分組，設定為：(0,90]、(90,120]、(120,150]、(150,500]，之後存成一個新的變數「片長分類」**\

```{r Prac5Quiz3, exercise = TRUE, exercise.lines = 15, exercise.eval = TRUE, message  = FALSE}
library(readr)
IMDBData <- read_csv("https://raw.githubusercontent.com/GaryLKL/course-programming-for-ds-Quiz/master/imdb_movies.csv")



```

```{r Prac5Quiz3-hint-1}
#3.
#150以上，可以使用 Inf ，為infinite無限大。
IMDBData %<>% mutate(
  片長分類=cut(片長,c(0,90,120,150,Inf)))
```

## Practice 6
*資料來源：[社會經濟資料服務平台](https://segis.moi.gov.tw/STAT/Web/Platform/QueryInterface/STAT_QueryInterface.aspx?Type=1#)*\

> Question 1

```{r Prac6Quiz1, exercise = TRUE, exercise.lines = 15, exercise.eval = TRUE, message  = FALSE}
library(readr)
data <- read_csv("https://raw.githubusercontent.com/GaryLKL/course-programming-for-ds-Quiz/master/Yilan.csv")



```

```{r Prac5Quiz3-hint-1}
#3.
#150以上，可以使用 Inf ，為infinite無限大。
IMDBData %<>% mutate(
  片長分類=cut(片長,c(0,90,120,150,Inf)))
```
